# 前端参数调整使用指南

## 🎯 功能概述

前端现在支持实时调整所有 TTS 参数，包括：
- 基础参数：音色、情感、语速、输出格式
- 高级参数：Temperature、Top-P、Top-K、Repetition Penalty

所有参数修改后会自动保存，并立即应用到下一次语音合成。

## 📱 界面说明

### 1. 打开设置界面

点击右上角的 **⚙️ 设置** 按钮，打开设置模态框。

### 2. 设置界面布局

```
┌─────────────────────────────────────────┐
│  设置                              ✕    │
├─────────────────────────────────────────┤
│                                         │
│  LLM 配置                               │
│  ├─ Base URL                            │
│  ├─ API Key                             │
│  └─ Model                               │
│                                         │
│  TTS 语音配置                           │
│  ├─ TTS API URL                         │
│  ├─ 音色 (Voice)                        │
│  ├─ 情感 (Emotion)                      │
│  ├─ 语速 (Speed) [滑块]                 │
│  ├─ 输出格式 [单选]                     │
│  └─ 高级参数 (Advanced) [可展开]        │
│     ├─ Temperature [滑块]               │
│     ├─ Top P [滑块]                     │
│     ├─ Top K [滑块]                     │
│     └─ Repetition Penalty [滑块]        │
│                                         │
│  [取消]              [保存并应用]        │
└─────────────────────────────────────────┘
```

## 🎛️ 参数详解

### 基础参数

#### 音色 (Voice)
- **输入框**：输入音色 ID
- **示例**：`default`, `voice_01`, `voice_02`
- **说明**：对应后端 `presets/` 目录下的文件夹名

#### 情感 (Emotion)
- **下拉选择**：
  - `默认 (default)` - 使用默认情感
  - `智能分析 (auto)` - 自动分析文本情感（需要配置 LLM）
  - `开心 (happy)` - 欢快、兴奋的语气
  - `悲伤 (sad)` - 低沉、难过的语气
  - `愤怒 (angry)` - 激动、生气的语气
  - `恐惧 (fear)` - 紧张、害怕的语气
  - `惊讶 (surprise)` - 意外、吃惊的语气
  - `中性 (neutral)` - 平静、客观的语气

#### 语速 (Speed)
- **滑块控制**：0.5x - 2.0x
- **实时显示**：当前值（如 1.20x）
- **参考标记**：
  - 左侧：慢速
  - 中间：正常
  - 右侧：快速

#### 输出格式
- **单选按钮**：
  - `WAV (高质量)` - 无损格式，文件较大
  - `MP3 (压缩)` - 压缩格式，文件较小

### 高级参数

点击 **"高级参数 (Advanced)"** 展开/收起。

#### Temperature (温度)
- **滑块**：0.1 - 2.0
- **默认**：1.0
- **说明**：控制生成的随机性
  - **0.1-0.5**：更稳定、一致，适合播音
  - **0.8-1.2**：平衡，适合对话
  - **1.5-2.0**：更随机、多变，适合情感表达

#### Top P (核采样)
- **滑块**：0.1 - 1.0
- **默认**：0.8
- **说明**：影响音色的多样性
  - **0.6-0.7**：更保守
  - **0.8**：推荐值
  - **0.9-1.0**：更多样

#### Top K (候选数量)
- **滑块**：5 - 50
- **默认**：20
- **说明**：控制候选 token 数量
  - **5-15**：更确定
  - **20**：推荐值
  - **30-50**：更灵活

#### Repetition Penalty (重复惩罚)
- **滑块**：0.5 - 2.0
- **默认**：1.0
- **说明**：防止重复生成
  - **0.5-0.9**：允许重复
  - **1.0**：无惩罚
  - **1.2-2.0**：减少重复

## 🎨 使用场景

### 场景 1: 新闻播报
```
音色: default
情感: neutral
语速: 1.0x
Temperature: 0.5
Top P: 0.6
Top K: 10
```
**效果**：稳定、清晰、专业

### 场景 2: 对话聊天
```
音色: default
情感: auto
语速: 1.1x
Temperature: 1.0
Top P: 0.8
Top K: 20
```
**效果**：自然、流畅、有变化

### 场景 3: 情感朗读
```
音色: default
情感: happy/sad
语速: 1.0x
Temperature: 1.3
Top P: 0.9
Top K: 30
```
**效果**：丰富、生动、有感染力

### 场景 4: 快速播报
```
音色: default
情感: neutral
语速: 1.5x
Temperature: 0.7
Top P: 0.7
Top K: 15
```
**效果**：高效、简洁、快速

## 💡 使用技巧

### 1. 参数调整顺序
建议按以下顺序调整：
1. 先选择音色和情感
2. 调整语速到合适的值
3. 如果需要，再调整高级参数
4. 测试效果，微调参数

### 2. 快速恢复默认
在高级参数区域，点击 **"恢复默认"** 按钮，一键重置所有高级参数。

### 3. 参数持久化
所有设置会自动保存到浏览器本地存储，下次打开自动恢复。

### 4. 实时生效
参数修改后点击 **"保存并应用"**，立即应用到下一次语音合成。

### 5. 批量测试
可以先调整参数，然后发送多条消息，观察不同文本的效果。

## 🔧 故障排除

### 问题 1: 参数不生效
**解决**：
1. 确认点击了 "保存并应用"
2. 检查浏览器控制台是否有错误
3. 刷新页面重试

### 问题 2: 音色不存在
**解决**：
1. 检查输入的音色 ID 是否正确
2. 访问 `/v1/voices` 查看可用音色列表
3. 确保后端 `presets/` 目录下有对应文件夹

### 问题 3: 情感不生效
**解决**：
1. 确认音色文件夹下有对应的情感文件（如 `happy.wav`）
2. 如果没有，会自动使用 `default.wav`
3. 使用 `auto` 需要配置 LLM API

### 问题 4: 高级参数效果不明显
**解决**：
1. 尝试更大的参数变化（如 Temperature 从 1.0 改到 0.5 或 1.5）
2. 使用较长的文本测试
3. 不同文本对参数的敏感度不同

## 📊 参数对比表

| 参数 | 低值效果 | 默认值 | 高值效果 |
|------|---------|--------|---------|
| Speed | 慢速、清晰 | 1.0 | 快速、高效 |
| Temperature | 稳定、一致 | 1.0 | 随机、多变 |
| Top P | 保守、确定 | 0.8 | 多样、灵活 |
| Top K | 确定性强 | 20 | 灵活性强 |
| Rep. Penalty | 允许重复 | 1.0 | 避免重复 |

## 🎯 最佳实践

1. **从默认开始**：先使用默认参数，确认基本功能正常
2. **逐步调整**：一次只调整一个参数，观察效果
3. **记录配置**：找到满意的配置后，记录下来
4. **场景预设**：为不同场景创建不同的配置组合
5. **定期测试**：更新音色或模型后，重新测试参数

## 📱 移动端适配

设置界面已适配移动端：
- 滑块可触摸操作
- 自动调整布局
- 支持滚动查看所有参数

## 🔄 更新日志

### v1.1.0 (2025-01-22)
- ✅ 添加所有高级参数支持
- ✅ 滑块可视化控制
- ✅ 参数说明和建议
- ✅ 一键恢复默认值
- ✅ 参数持久化存储
- ✅ 实时生效机制

## 📚 相关文档

- [TTS 参数指南](./TTS_PARAMETERS_GUIDE.md) - 详细的参数说明
- [API 文档](./README.md) - 后端 API 接口
- [前端架构](./frontend/ARCHITECTURE.md) - 前端技术架构
